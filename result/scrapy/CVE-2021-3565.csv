"url","domain","state","text"
"https://bugzilla.redhat.com/show_bug.cgi?id=1964427","bugzilla.redhat.com","0","Title:
CVE-2021-3565 tpm2-tools: fixed AES wrapping key in tpm2_import

Attributes:
Keywords:
Security
Status:
CLOSED
          ERRATA
Alias:
CVE-2021-3565
Product:
Security Response
Classification:
Other
Component:
vulnerability
Sub Component:
---
Version:
unspecified
Hardware:
All
OS:
        Linux
Priority:
medium
Severity:
       medium
Target Milestone:
---
Assignee:
Red Hat Product Security
QA Contact:
Docs Contact:
URL:
Whiteboard:
Depends On:
1964428 1964429 1965981 1965982
Blocks:
1964113 1964430
TreeView+
        depends on /
        blocked
Reported:
2021-05-25 13:26 UTC by Guilherme de Almeida Suckevicz
Modified:
2023-08-08 02:58 UTC
      (History)
CC List:
6 
          users
            (show)
bhu
core-kernel-mgr
fmartine
jsnitsel
pbrobinson
yunying.sun
Fixed In Version:
tpm2-tools 5.1.1, tpm2-tools 4.3.2
Doc Type:
If docs needed, set a value
Doc Text:
A flaw was found in tpm2-tools. tpm2_import used a fixed AES key for the inner wrapper, potentially allowing a MITM attacker to unwrap the inner portion and reveal the key being imported. The highest threat from this vulnerability is to data confidentiality.
Clone Of:
Environment:
Last Closed:
2021-11-10 00:22:26 UTC
Embargoed:


Comments:
Description
Guilherme de Almeida Suckevicz
          2021-05-25 13:26:14 UTC
During tpm2_import command invocation a fixed AES wrapping key is used. This presents a weakness in that, when no encrypted session with the TPM is used, the encrypted inner wrapper key is known and thus an entity performing an MITM on the TPM would be able to unwrap the inner portion and reveal the key being imported.
Comment 1
Guilherme de Almeida Suckevicz
          2021-05-25 13:27:05 UTC
Created tpm2-tools tracking bugs for this issue:
Affects: epel-7 [bug 1964429]
Affects: fedora-all [bug 1964428]
Comment 3
Mauro Matteo Cascella
          2021-05-31 09:45:50 UTC
Upstream issue:
https://github.com/tpm2-software/tpm2-tools/issues/2738
Upstream commit:
https://github.com/tpm2-software/tpm2-tools/commit/c069e4f179d5e6653a84fb236816c375dca82515
Comment 5
errata-xmlrpc
          2021-11-09 18:41:54 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8
Via RHSA-2021:4413 https://access.redhat.com/errata/RHSA-2021:4413
Comment 6
Product Security DevOps Team
          2021-11-10 00:22:24 UTC
This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):
https://access.redhat.com/security/cve/cve-2021-3565
"
"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/ESY6HRYUKR5ZG2K5QAJQC5S6HMKZMFK7/","lists.fedoraproject.org","0","Title:

[SECURITY] Fedora 33 Update: tpm2-tools-4.3.2-1.fc33

Post:
--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-00a15ad850
2021-06-30 03:32:19.004425
--------------------------------------------------------------------------------

Name        : tpm2-tools
Product     : Fedora 33
Version     : 4.3.2
Release     : 1.fc33
URL         : https://github.com/tpm2-software/tpm2-tools
Summary     : A bunch of TPM testing toolS build upon tpm2-tss
Description :
tpm2-tools is a batch of tools for tpm2.0. It is based on tpm2-tss.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-3565
--------------------------------------------------------------------------------
ChangeLog:

* Mon Jun 21 2021 Peter Robinson <pbrobinson(a)fedoraproject.org&gt; - 4.3.2-1
- Update to 4.3.2
- Fixes CVE-2021-3565 (rhbz 1964428)
--------------------------------------------------------------------------------
References:

  [ 1 ] Bug #1964427 - CVE-2021-3565 tpm2-tools: fixed AES wrapping key in tpm2_import
        https://bugzilla.redhat.com/show_bug.cgi?id=1964427
--------------------------------------------------------------------------------

This update can be installed with the ""dnf"" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-00a15ad850' at the command
line. For more information, refer to the dnf documentation available at
http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
https://fedoraproject.org/keys
--------------------------------------------------------------------------------

    "
"https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XK5M7I66PBXSN663TSLAZ3V6TWWFCV7C/","lists.fedoraproject.org","0","Title:

[SECURITY] Fedora 34 Update: tpm2-tools-5.1.1-1.fc34

Post:
--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2021-c970c02748
2021-06-30 03:14:45.433940
--------------------------------------------------------------------------------

Name        : tpm2-tools
Product     : Fedora 34
Version     : 5.1.1
Release     : 1.fc34
URL         : https://github.com/tpm2-software/tpm2-tools
Summary     : A bunch of TPM testing toolS build upon tpm2-tss
Description :
tpm2-tools is a batch of tools for tpm2.0. It is based on tpm2-tss.

--------------------------------------------------------------------------------
Update Information:

Security fix for CVE-2021-3565
--------------------------------------------------------------------------------
ChangeLog:

* Mon Jun 21 2021 Peter Robinson <pbrobinson(a)fedoraproject.org&gt; - 5.1.1-1
- Update to 5.1.1
- Fixes CVE-2021-3565 (rhbz 1964428)
--------------------------------------------------------------------------------
References:

  [ 1 ] Bug #1964427 - CVE-2021-3565 tpm2-tools: fixed AES wrapping key in tpm2_import
        https://bugzilla.redhat.com/show_bug.cgi?id=1964427
--------------------------------------------------------------------------------

This update can be installed with the ""dnf"" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2021-c970c02748' at the command
line. For more information, refer to the dnf documentation available at
http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
https://fedoraproject.org/keys
--------------------------------------------------------------------------------

    "
