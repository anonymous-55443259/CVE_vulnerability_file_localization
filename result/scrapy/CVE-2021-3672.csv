"url","domain","state","text"
"https://bugzilla.redhat.com/show_bug.cgi?id=1988342","bugzilla.redhat.com","0","Title:
CVE-2021-3672 c-ares: Missing input validation of host names may lead to domain hijacking

Attributes:
Keywords:
Security
Status:
CLOSED
          ERRATA
Alias:
CVE-2021-3672
Product:
Security Response
Classification:
Other
Component:
vulnerability
Sub Component:
---
Version:
unspecified
Hardware:
All
OS:
        Linux
Priority:
medium
Severity:
       medium
Target Milestone:
---
Assignee:
Red Hat Product Security
QA Contact:
Docs Contact:
URL:
Whiteboard:
Depends On:
1989425 1989426 1989427 1989429 1992221 1992222 1994398 1994399 1994400 1994401 1994942 1994943 1994963 1995019 1995020 2014523
Blocks:
1988343 1988352
TreeView+
        depends on /
        blocked
Reported:
2021-07-30 10:36 UTC by Marian Rehak
Modified:
2022-05-17 09:58 UTC
      (History)
CC List:
16 
          users
            (show)
aboscatt
atikhono
casper
gkamathe
hhorak
jhrozek
jorton
jstanek
msiddiqu
nagy.martin
nodejs-maint
security-response-team
sgoveas
spotrh
valtri
zsvetlik
Fixed In Version:
c-ares 1.17.2
Doc Type:
If docs needed, set a value
Doc Text:
A flaw was found in c-ares library, where a missing input validation check of host names returned by DNS (Domain Name Servers) can lead to output of wrong hostnames which might potentially lead to Domain Hijacking. The highest threat from this vulnerability is to confidentiality and integrity as well as system availability.
Clone Of:
Environment:
Last Closed:
2021-08-26 15:34:55 UTC
Embargoed:


Comments:
Description
Marian Rehak
          2021-07-30 10:36:18 UTC
Missing input validation of host names returned by Domain Name Servers in the c-ares library can lead to output of wrong hostnames (leading to Domain Hijacking).
Comment 15
Guilherme de Almeida Suckevicz
          2021-08-10 18:20:48 UTC
Created c-ares tracking bugs for this issue:
Affects: fedora-all [bug 1992221]
Created mingw-c-ares tracking bugs for this issue:
Affects: fedora-all [bug 1992222]
Comment 16
Tomas Hoger
          2021-08-12 08:36:41 UTC
c-ares upstream advisory:
https://c-ares.haxx.se/adv_20210810.html
Patch linked form the above upstream advisory:
https://github.com/c-ares/c-ares/compare/809d5e8..44c009b.patch
Comment 20
errata-xmlrpc
          2021-08-26 10:15:21 UTC
This issue has been addressed in the following products:
  Red Hat Software Collections for Red Hat Enterprise Linux 7
  Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS
Via RHSA-2021:3281 https://access.redhat.com/errata/RHSA-2021:3281
Comment 21
errata-xmlrpc
          2021-08-26 10:18:49 UTC
This issue has been addressed in the following products:
  Red Hat Software Collections for Red Hat Enterprise Linux 7
  Red Hat Software Collections for Red Hat Enterprise Linux 7.7 EUS
Via RHSA-2021:3280 https://access.redhat.com/errata/RHSA-2021:3280
Comment 22
Product Security DevOps Team
          2021-08-26 15:34:55 UTC
This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):
https://access.redhat.com/security/cve/cve-2021-3672
Comment 23
errata-xmlrpc
          2021-09-21 13:12:20 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8
Via RHSA-2021:3623 https://access.redhat.com/errata/RHSA-2021:3623
Comment 24
errata-xmlrpc
          2021-09-22 08:51:32 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8.1 Extended Update Support
Via RHSA-2021:3639 https://access.redhat.com/errata/RHSA-2021:3639
Comment 25
errata-xmlrpc
          2021-09-22 09:00:49 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8.2 Extended Update Support
Via RHSA-2021:3638 https://access.redhat.com/errata/RHSA-2021:3638
Comment 26
errata-xmlrpc
          2021-09-27 07:28:59 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8
Via RHSA-2021:3666 https://access.redhat.com/errata/RHSA-2021:3666
Comment 27
gkamathe
          2021-12-14 13:43:23 UTC
Attack Complexity has been rated as high because an attacker would either need to have a legitimate DNS server under his control which have the malicious records with zero-bytes or trick the user into querying another rogue DNS server
Comment 28
errata-xmlrpc
          2022-05-10 15:07:20 UTC
This issue has been addressed in the following products:
  Red Hat Enterprise Linux 8
Via RHSA-2022:2043 https://access.redhat.com/errata/RHSA-2022:2043
"
"https://security.gentoo.org/glsa/202401-02","security.gentoo.org","0","c-ares: Multiple Vulnerabilities
— GLSA 202401-02Multiple vulnerabilities have been found in c-ares, the worst of which could result in the loss of confidentiality or integrity.
Affected packages
Package
net-dns/c-ares on all architectures
Affected versions
< 1.19.0
Unaffected versions
>= 1.19.0
Background
c-ares is a C library for asynchronous DNS requests (including name resolves).
Description
Multiple vulnerabilities have been discovered in c-ares. Please review the CVE identifiers referenced below for details.
Impact
Please review the referenced CVE identifiers for details.
Workaround
There is no known workaround at this time.
Resolution
All c-ares users should upgrade to the latest version:
# emerge --sync
# emerge --ask --oneshot --verbose "">=net-dns/c-ares-1.19.0""
References
CVE-2021-3672
CVE-2021-22930
CVE-2021-22931
CVE-2021-22939
CVE-2021-22940
CVE-2022-4904"
"https://c-ares.haxx.se/adv_20210810.html","c-ares.haxx.se","0","c-ares home ·
docs ·
license ·
mail archive ·
why ·
other libs ·
github
CVE-2021-3672
Missing input validation on hostnames returned by DNS servers
Project c-ares Security Advisory, August 10, 2021 -
Permalink
VULNERABILITY
Missing input validation of host names returned by Domain Name Servers in
the c-ares library can lead to output of wrong hostnames (leading to Domain
Hijacking).
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2021-3672 to this issue.
STEPS TO REPRODUCE
An example domain which has a cname including a zero byte:
```
$ adig cnamezero.test2.xdi-attack.net
Answers:
cnamezero.test2.xdi-attack.net. 0 CNAME victim.test2.xdi-attack.net\000.test2.xdi-attack.net.
victim.test2.xdi-attack.net\000.test2.xdi-attack.net. 0 A 141.12.174.88
```
When resolved via a vulnerable implementation, the CNAME alias and name of the
A record will seem to be victim.test2.xdi-attack.net instead of
victim.test2.xdi-attack.net\000.test2.xdi-attack.net, a totally different
domain.
This is a clear error in zero-byte handling and can potentially lead to
DNS-cache injections in case an application implements a cache based on the
library.
AFFECTED VERSIONS
This flaw exists in the following c-ares versions.
Affected versions: c-ares 1.0.0 to and including 1.17.1
Not affected versions: c-ares >= 1.17.2
THE SOLUTION
In version 1.17.2, the function has been corrected and a test case have been
added to verify.
A patch for
CVE-2021-3672
is available.
RECOMMENDATIONS
We suggest you take one of the following actions immediately, in order of
preference:
A - Upgrade c-ares to version 1.17.2
B - Apply the patch to your version and rebuild
TIME LINE
It was reported to the c-ares project on June 11, 2021 by Philipp Jeitner and
Haya Shulman, Fraunhofer SIT.
c-ares 1.17.2 was released on August 10 2021, coordinated with the publication
of this advisory.
CREDITS
Thanks to Philipp Jeitner and Haya Shulman, Fraunhofer SIT for the report."
